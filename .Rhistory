class(fx.time.stamps)
head(dates(as.character(fx.time.stamps))
)
head(hour10to11)
names(index(hour10to11,0))
names(fx.time.stamps)
head(hour10to11)
temp<-as.Date(fx.time.stamps)
head(temp)
tail(temp)
class(temp)
length(temp)
length(hour10to11)
temp<-as.Date(index(hour10to11,0))
length(temp)
temp<-xts(hour10to11$fxrate,as.Date(index(hour10to11,0)))
head(temp)
by(temp,index(temp,0),mean)
twap<-by(temp,index(temp,0),mean)
head(temp)
head(twap)
length(twap)
head(fix.prices)
twap<-as.vector(by(temp,index(temp,0),mean))
head(twap)
head(warnings())
twap<-as.vector(by(temp,index(temp,0),colmeans))
twap<-as.vector(by(temp,index(temp,0),colmean))
twap<-as.vector(by(temp,index(temp,0),mean))
twap<-xts(as.vector(by(temp,index(temp,0),mean)),index(fix.prices,0))
twap<-suppressWarnings(xts(as.vector(by(temp,index(temp,0),mean)),index(fix.prices,0)))
head(twap)
twap<-suppressWarnings(xts(as.vector(by(temp,index(temp,0),mean)),index(fix.prices,0)))
names(twap)<"twap"
head(twap)
twap<-suppressWarnings(xts(as.vector(by(temp,index(temp,0),mean)),index(fix.prices,0)))
names(twap)<-"twap"
head(twap)\
head(twap)
length(twap)
head(fix.prices)
rm(twap)
twap10to11<-suppressWarnings(xts(as.vector(by(temp,index(temp,0),mean)),index(fix.prices,0)))
names(twap10to11)<-"twap"
LHS<-(fix.prices-twap10to11)
RHS<-list.americas+list.europe+list.asiapac+list.africame+list.commod # Dependent variables declaration...
RHS<-list(list.americas, list.europe, list.asiapac, list.africame, list.commod)
form<-formula(LHS~RHS)
the_model<-specifyModel(form, na.rm=TRUE)
?specifyModel
RHS<-c(list.americas)
form<-formula(LHS~RHS)
the_model<-specifyModel(form, na.rm=TRUE)
RHS<-c(list.americas[[1:5]])
RHS<-c(list.americas[1:5])
head(RHS)
class(RHS)
?append
?list
temp<-unlist(list.americas)
head(temp)
temp<-as.data.frame(list.americas)
rm(list.africame,list.americas,list.asiapac,list.commod,list.europe)
indices.americas<-c(MERV[first.date],BVSP[first.date],GSPTSE[first.date],IPC[first.date],GSPC[first.date],DOW[first.date])
RHS<-c(indices.americas)
form<-formula(LHS~RHS)
the_model<-specifyModel(form, na.rm=TRUE) # returns an object of class "quantmod".
head(LHS)
name(LHS)<-"pips"
names(LHS)<-"pips"
?formula
paste("MERV[first.date]","MCX[first.date],sep="+")
)
)
paste("MERV[first.date]","MCX[first.date]",sep="+")
RHS<-paste("MERV[first.date]","BVSP[first.date]","GSPTSE[first.date]","IPC[first.date]","GSPC[first.date]","DOW[first.date]",
"AORD[first.date]","SSEC[first.date]","HSI[first.date]","BSESN[first.date]","JKSE[first.date]","KLSE[first.date]",
"N225[first.date]","NZ50[first.date]","STI[first.date]","KS11[first.date]","TWII[first.date]",
"ATX[first.date]","BFX[first.date]","FCHI[first.date]","GDAXI[first.date]","AEX[first.date]",
"OSEAX[first.date]","OMXSPI[first.date]","SSMI[first.date]","FTSE[first.date]",
"MCX[first.date]","GD.AT[first.date]","TA100[first.date]","DJC[first.date]", sep="+")
RHS
form<-formula(LHS~RHS)
the_model<-specifyModel(form, na.rm=TRUE)
RHS<-c(MERV[first.date],BVSP[first.date],GSPTSE[first.date],IPC[first.date],GSPC[first.date],DOW[first.date],
AORD[first.date],SSEC[first.date],HSI[first.date],BSESN[first.date],JKSE[first.date],KLSE[first.date],
N225[first.date],NZ50[first.date],STI[first.date],KS11[first.date],TWII[first.date],
ATX[first.date],BFX[first.date],FCHI[first.date],GDAXI[first.date],AEX[first.date],
OSEAX[first.date],OMXSPI[first.date],SSMI[first.date],FTSE[first.date],
MCX[first.date],GD.AT[first.date],TA100[first.date],DJC[first.date])
form<-formula(LHS~RHS)
the_model<-specifyModel(form, na.rm=TRUE)
form<-c("LHS~MERV[first.date]+BVSP[first.date]+GSPTSE[first.date]+IPC[first.date]+GSPC[first.date]+DOW[first.date]+
AORD[first.date]+SSEC[first.date]+HSI[first.date]+BSESN[first.date]+JKSE[first.date]+KLSE[first.date]+
N225[first.date]+NZ50[first.date]+STI[first.date]+KS11[first.date]+TWII[first.date]+
ATX[first.date]+BFX[first.date]+FCHI[first.date]+GDAXI[first.date]+AEX[first.date]+
OSEAX[first.date]+OMXSPI[first.date]+SSMI[first.date]+FTSE[first.date]+
MCX[first.date]+GD.AT[first.date]+TA100[first.date]+DJC[first.date]")
the_model<-specifyModel(form, na.rm=TRUE)
form
form<-as.formula("LHS~MERV[first.date]+BVSP[first.date]+GSPTSE[first.date]+IPC[first.date]+GSPC[first.date]+DOW[first.date]+
AORD[first.date]+SSEC[first.date]+HSI[first.date]+BSESN[first.date]+JKSE[first.date]+KLSE[first.date]+
N225[first.date]+NZ50[first.date]+STI[first.date]+KS11[first.date]+TWII[first.date]+
ATX[first.date]+BFX[first.date]+FCHI[first.date]+GDAXI[first.date]+AEX[first.date]+
OSEAX[first.date]+OMXSPI[first.date]+SSMI[first.date]+FTSE[first.date]+
MCX[first.date]+GD.AT[first.date]+TA100[first.date]+DJC[first.date]")
the_model<-specifyModel(form, na.rm=TRUE)
class(form)
form<-as.formula(LHS~MERV[first.date]+BVSP[first.date]+GSPTSE[first.date]+IPC[first.date]+GSPC[first.date]+DOW[first.date]+
AORD[first.date]+SSEC[first.date]+HSI[first.date]+BSESN[first.date]+JKSE[first.date]+KLSE[first.date]+
N225[first.date]+NZ50[first.date]+STI[first.date]+KS11[first.date]+TWII[first.date]+
ATX[first.date]+BFX[first.date]+FCHI[first.date]+GDAXI[first.date]+AEX[first.date]+
OSEAX[first.date]+OMXSPI[first.date]+SSMI[first.date]+FTSE[first.date]+
MCX[first.date]+GD.AT[first.date]+TA100[first.date]+DJC[first.date])
the_model<-specifyModel(form, na.rm=TRUE)
temp<-AEX~AORD+ATX
specifyModel(temp,na.rm=TRUE)
form<-LHS~MERV[first.date]+BVSP[first.date]+GSPTSE[first.date]+IPC[first.date]+GSPC[first.date]+DOW[first.date]+
AORD[first.date]+SSEC[first.date]+HSI[first.date]+BSESN[first.date]+JKSE[first.date]+KLSE[first.date]+
N225[first.date]+NZ50[first.date]+STI[first.date]+KS11[first.date]+TWII[first.date]+
ATX[first.date]+BFX[first.date]+FCHI[first.date]+GDAXI[first.date]+AEX[first.date]+
OSEAX[first.date]+OMXSPI[first.date]+SSMI[first.date]+FTSE[first.date]+
MCX[first.date]+GD.AT[first.date]+TA100[first.date]+DJC[first.date]
the_model<-specifyModel(form, na.rm=TRUE)
temp<-AEX~AORD[first.date]+ATX[first.date]
specifyModel(temp,na.rm=TRUE)
class(temp)
first.date
form<-LHS~MERV+BVSP+GSPTSE+IPC+GSPC+DOW+AORD+SSEC+HSI+BSESN+JKSE+KLSE+N225+NZ50+STI+KS11+TWII+ATX+BFX+FCHI+GDAXI+AEX+
OSEAX+OMXSPI+SSMI+FTSE+MCX+GD.AT+TA100+DJC
the_model<-specifyModel(form, na.rm=TRUE)
suppressWarnings(library(zoo))
suppressWarnings(library(xts))
suppressWarnings(library(quantmod))
suppressWarnings(library(PerformanceAnalytics))
suppressWarnings(library(ggplot2))
suppressWarnings(library(plyr))
suppressWarnings(library(knitr))
suppressWarnings(library(chron))
the_model<-specifyModel(form, na.rm=TRUE)
form<-LHS~MERV+BVSP+GSPTSE+IPC+GSPC+DOW+AORD+SSEC+HSI+BSESN+JKSE+KLSE+N225+NZ50+STI+KS11+TWII+ATX+BFX+FCHI+GDAXI+AEX+
+SSMI+FTSE+GD.AT+TA100+DJC
the_model<-specifyModel(form, na.rm=TRUE)
form<-LHS~MERV+BVSP
the_model<-specifyModel(form, na.rm=TRUE)
the_model<-specifyModel(form, na.rm=FALSE)
?specifyModel
class(MERV)
?getModelData
form<-"LHS~MERV+BVSP"
the_model<-specifyModel(form, na.rm=FALSE)
specifyModel
form<-LHS~MERV+BVSP
form<-as.formula(LHS~MERV+BVSP)
?all.vars
all.vars(form)
form
?deparse
deparse(form)
the_model<-specifyModel(form, na.rm=FALSE)
head(MERV)
head(BVSP)
head(LHS)
form<-as.formula(LHS~Cl(MERV)+Cl(BVSP))
the_model<-specifyModel(form, na.rm=FALSE)
cl(MERV)
Cl(MERV)
head(MERV)
head(Cl(MERV))
?formula
terms(form)
form<-as.formula(Cl(MERV)~Cl(BVSP))
terms(form)
the_model<-specifyModel(form, na.rm=FALSE)
class(LHS)
class(MERV)
twap10to11<-suppressWarnings(xts(as.vector(by(hour10to11,index(hour10to11,0),mean)),index(fix.prices,0)))
twap10to11<-suppressWarnings(xts(as.vector(by(LHS,index(LHS,0),mean)),index(fix.prices,0)))
fx.allt<-xts(data,order.by=fx.time.stamps) # All of the FX data for this pair...
names(fx.allt)<-"fxrate"
fix.prices<-fx.allt[index(fx.allt,0)$hour==11 & index(fx.allt,0)$min==0]
twap10to11<-suppressWarnings(xts(as.vector(by(fx.allt,index(fx.allt,0),mean)),index(fix.prices,0)))
length(fix.prices)
length(hour10to11)
head(fx.allt)
head(index(fix.prices,0))
tempdts<-as.Date(index(fix.allt,0))
tempdts<-as.Date(index(fx.allt,0))
head(tempdts)
length(tempdts)
length(fx.allt)
head(fx.allt)
tempfx<-as.vector(fx.allt)
head(tempfx)
length(tempfx)
rm(tempdts,tempfx)
head(tempxts)
tempxts<-xts(as.vector(fx.allt),as.Date(index(fx.allt,0)))
head(tempxts)
twap10to11<-suppressWarnings(xts(as.vector(by(tempxts,index(tempxts,0),mean)),index(fix.prices,0)))
temp<-by(tempxts,index(tempxts,0),mean)
head(temp)
head(as.vector(temp))
temp<-as.vector(by(tempxts,index(tempxts,0),mean))
head(temp)
length(temp)
length(tempxts)
length(temp)
tail(tempxts)
tempxts<-xts(as.vector(hour10to11),as.Date(index(hour10to11,0)))
twap10to11<-suppressWarnings(xts(as.vector(by(tempxts,index(tempxts,0),mean)),index(fix.prices,0)))
head(twap10to11)
length(twap10to11)
names(twap10to11)<-"twap"
rm(tempxts)
head(twap10to11)
LHS<-(fix.prices-twap10to11)
names(LHS)<-"pips"
form<-as.formula(Cl(MERV)~Cl(BVSP))
the_model<-specifyModel(form, na.rm=FALSE)
form<-as.formula(LHS~Cl(MERV)~Cl(BVSP))
the_model<-specifyModel(form, na.rm=FALSE)
class(LHS)
length(LHS)
class(Cl(MERV))
length(Cl(MERV))
head(LHS)
temp<-merge.xts(LHS,Cl(MERV),Cl(BVSP))
head(temp)
tail(temp)
temp<-merge.xts(LHS,Cl(MERV),join="outer")
head(temp)
tail(temp)
tail(LHS)
temp<-merge.xts(LHS,Cl(MERV),join="inner")
head(temp)
density(LHS)
plot(density(LHS))
plot(density(fix.prices))
lines(density(twap10to11),col="red")
summary(LHS)
plot(twap10to11)
class(twap10to11)
plot.xts(twap10to11)
head(twap10to11)
plot(twap10to11$twap)
plot(LHS)
length(MERV)
length(BVSP)
form<-as.formula(Cl(MERV)~Cl(BVSP)+Cl(GSPTSE))
the_model<-specifyModel(form, na.rm=FALSE)
head(MERV)
as.quantmod.OHLC(LHS,
col.names = c("Open", "High",
"Low", "Close",
"Volume", "Adjusted"),
name = NULL)
head(LHS)
length(LHS)
lhs.o<-rep(0,length(LHS))
head(lhs.o)
length(lhs.o)
lhs.o<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.h<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.l<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.c<-xts(rep(0,length(LHS)),index(LHS,0))
temp<-merge.xts(LHS,lhs.o,lhs.h,lhs.l,lhs.c)
head(temp)
head(MERV)
lhs.o<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.h<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.l<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.c<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.v<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.a<-xts(rep(0,length(LHS)),index(LHS,0))
LHS<-merge.xts(LHS,lhs.o,lhs.h,lhs.l,lhs.c,lhs.v,lhs.a)
head(LHS)
LHS<-as.quantmod.OHLC(x,
col.names = c("Open", "High",
"Low", "Close",
"Volume", "Adjusted"),
name = NULL)
LHS<-as.quantmod.OHLC(LHS,
col.names = c("Open", "High",
"Low", "Close",
"Volume", "Adjusted"),
name = NULL)
numcols(LHS)
colnum(LHS)
head(LHS)
LHS<-LHS[,-lhs.a]
head(LHS)
LHS<-(fix.prices-twap10to11)
lhs.h<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.l<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.c<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.v<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.a<-xts(rep(0,length(LHS)),index(LHS,0))
LHS<-merge.xts(LHS,lhs.h,lhs.l,lhs.c,lhs.v,lhs.a)
LHS<-as.quantmod.OHLC(LHS,
col.names = c("Open", "High",
"Low", "Close",
"Volume", "Adjusted"),
name = NULL)
head(LHS)
class(LHS)
form<-as.formula(Op(LHS)~Cl(MERV)~Cl(BVSP)+Cl(GSPTSE))
the_model<-specifyModel(form, na.rm=FALSE)
ncol(Op(LHS))
ncol(Cl(MERV))
ncol(Cl(BVSP))
ncol(Cl(GSPTSE))
LHS<-Op(LHS)
LHS<-as.xts(Op(LHS))
form<-as.formula(LHS~Cl(MERV)~Cl(BVSP)+Cl(GSPTSE))
the_model<-specifyModel(form, na.rm=FALSE)
?specifyModel
form<-as.formula(Op(LHS)~Cl(MERV)+Cl(BVSP)+Cl(GSPTSE))
the_model<-specifyModel(form, na.rm=FALSE)
the_model<-specifyModel(Op(LHS)~Cl(MERV)+Cl(BVSP)+Cl(GSPTSE), na.rm=FALSE)
form<-as.formula(Op(LHS)~Cl(MERV))
the_model<-specifyModel(form, na.rm=FALSE)
form<-as.formula(Op(LHS)~Op(LHS))
the_model<-specifyModel(form, na.rm=FALSE)
LHS<-(fix.prices-twap10to11)
lhs.h<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.l<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.c<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.v<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.a<-xts(rep(0,length(LHS)),index(LHS,0))
LHS<-merge.xts(LHS,lhs.h,lhs.l,lhs.c,lhs.v,lhs.a)
LHS<-as.quantmod.OHLC(LHS,
col.names = c("Open", "High",
"Low", "Close",
"Volume", "Adjusted"),
name = NULL)
form<-as.formula(Op(LHS)~Op(LHS))
the_model<-specifyModel(form, na.rm=FALSE)
form<-as.formula(Op(LHS)~Op(MERV))
the_model<-specifyModel(form, na.rm=FALSE)
form<-as.formula(Op(MERV)~Op(MERV))
the_model<-specifyModel(form, na.rm=FALSE)
form<-as.formula(Op(MERV)~Op(MCX))
the_model<-specifyModel(form, na.rm=FALSE)
head(LHS)
head(MERV)
LHS<-xts((fix.prices-twap10to11),index(fix.prices,0))
lhs.h<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.l<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.c<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.v<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.a<-xts(rep(0,length(LHS)),index(LHS,0))
LHS<-merge.xts(LHS,lhs.h,lhs.l,lhs.c,lhs.v,lhs.a)
LHS<-as.quantmod.OHLC(LHS,
col.names = c("Open", "High",
"Low", "Close",
"Volume", "Adjusted"),
name = NULL)
head(LHS)
LHS<-xts((fix.prices-twap10to11),as.Date(index(fix.prices,0)))
lhs.h<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.l<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.c<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.v<-xts(rep(0,length(LHS)),index(LHS,0))
lhs.a<-xts(rep(0,length(LHS)),index(LHS,0))
LHS<-merge.xts(LHS,lhs.h,lhs.l,lhs.c,lhs.v,lhs.a)
LHS<-as.quantmod.OHLC(LHS,
col.names = c("Open", "High",
"Low", "Close",
"Volume", "Adjusted"),
name = NULL)
head(LHS)
class(LHS)
head(Op(LHS))
form<-as.formula(Op(LHS)~Op(MCX))
the_model<-specifyModel(form, na.rm=FALSE)
form<-as.formula(Op(MERV)~Op(MCX))
the_model<-specifyModel(form, na.rm=FALSE)
specifyModel
form<-as.formula(Op(LHS)~Op(MCX))
#+SSMI+FTSE+GD.AT+TA100+DJC+SEAX+OMXSPI+MCX
new.quantmod <- new("quantmod")
formula <- as.formula(form)
dot.vars <- all.vars(formula)
dot.vars
formula
convert.vars <- function(vars) {
v <- unlist(strsplit(vars, "[.]"))
v <- paste(v[1], "(", v[2], if (length(v) > 2)
paste(",", v[3], sep = ""), ")", sep = "")
return(v)
}
new.quantmod@model.spec <- formula
new.quantmod@model.formula <- as.formula(gsub("[) ]", "",
gsub("[(,=:^'\"]", ".", deparse(formula))))
new.quantmod@model.target <- as.character(new.quantmod@model.formula[[2]])
new.quantmod@build.inputs <- as.character(attr(terms(new.quantmod@model.formula),
"term.labels"))
vars <- all.vars(formula)
new.quantmod@symbols <- vars
new.quantmod@product <- vars[1]
new.quantmod <- getModelData(new.quantmod, na.rm = na.rm)
getModelData
new.quantmod.symbols
new.quantmod
new.quantmod@symbols
length(new.quantmod@model.inputs)
?getModelData
the_model
rm(new.quantmod)
getModelData
temp<- get("LHS", env)
env<-new.env()
temp<- get("LHS", env)
?formula
head(LHS)
merge.xts(Op(LHS),Op(MERV),join="inner")
merge.xts(Op(LHS),Op(MERV),join="outer")
tail(Op(LHS))
?merge.xts
merge.xts(Op(LHS),Op(MERV),join="left")
head(Op(LHS))
merge.xts(Op(LHS),Op(MERV),join="inner")
merge.xts(Op(LHS),Op(MERV),join="left")
?merge.zoo
temp<-merge(Op(LHS),Op(MERV), all = TRUE, fill = NA, suffixes = NULL,
check.names = FALSE, retclass ="data.frame",
drop = TRUE)
temp<-merge(Op(LHS),Op(MERV), all = TRUE, fill = NA, suffixes = NULL,
check.names = FALSE, retclass ="data.frame",
drop = FALSE)
form<-as.formula(Op(LHS)~Cl(MCX)+Cl(BVSP)+Cl(GSPTSE))
the_model<-lm(form)
head(Op(LHS))
head(Cl(MERV))
temp<-merge.xts(Op(LHS),Cl(MERV),join="left")
head(temp)
temp<-merge.xts(Op(LHS),Cl(MERV),join="right")
head(temp)
temp
temp<-merge.xts(Op(LHS),Cl(MERV),join="inner")
head(temp)
temp
temp<-merge.xts(Op(LHS),Cl(MERV),join="outer")
head(temp)
temp
head(temp)
the_model<-lm(LHS.Open~MERV.Close,data=temp)
summary(the_model)
temp<-temp[temp$LHS.Open!=NA]
head(temp)
temp
temp<-merge.xts(Op(LHS),Cl(MERV),join="outer")
head(temp)
temp<-na.omit(temp)
head(temp)
length(temp$LHS.Open)
the_model<-lm(LHS.Open~MERV.Close,data=temp)
the_model
summary(the_model)
?specifyModel
form<-as.formula(Op(LHS)~Cl(MERV)+Cl(BVSP)+Cl(GSPTSE))
the_model<-specifyModel(form,na.rm=TRUE)
the_model
?buildModel
head(OP(LHS))
head(Op(LHS))
head(Op(LHS),60)
buildModel(the_model,method='lm',training.per=c('2012-01-02','2012-03-23'))
the_model
tradeModel(the_model)
buildModel(the_model,method='lm',training.per=c('2012-01-02','2012-03-23'))
fittedModel(the_model)
class(the_model)
formula(the_model)
plot(the_model)
coefficients(the_model)
the_model
buildModel(the_model,method="lm")
buildModel(the_model,method="lm",training.per=c('2012-01-02','2012-03-23'))
the_model
head(LHS)
Op(LHS)
plot(Op(LHS))
plot.xts(Op(LHS))
the_model
the_model.b<-buildModel(the_model,method='lm',training.per=c('2012-01-02','2012-03-23'))
the_model.b
rm(the_model.b)
fittedModel(the_model.build)
the_model.build<-buildModel(the_model,method='lm',training.per=c('2012-01-02','2012-03-23'))
fittedModel(the_model.build)
plot(the_model.build)
plot(the_model.build)
coefficients(the_model.build)
coef(the_model.build)
plot(residuals(the_model.build))
plot(residuals(the_model.build),type="l")
plot(fit,type="l",main="Fitted Values")
fit<-fittedValues(the_model.build)
plot(fit,type="l",main="Fitted Values")
fit<-fitted.values(the_model.build)
plot(fit,type="l",main="Fitted Values")
plot.xts(the_model.build)
plot(the_model.build)
plot.xts(residuals(the_model.build),type="l")
plot(residuals(the_model.build),type="l")
fit<-fitted.values(the_model.build)
plot(fit,type="l",main="Fitted Values")
lines(Op(LHS),col="red")
plot(Op(LHS),col="red")
lines(fit,type="l",col="blue")
